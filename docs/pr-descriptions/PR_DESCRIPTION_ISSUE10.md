# [UI] グローバルナビゲーション（Header/Footer）の実装

## 概要

Issue #10の対応として、サイト全体で共通のヘッダーとフッターを実装しました。これにより、ユーザーはどのページからでも主要な機能（シナリオ検索・AI解析）にアクセスでき、ログイン状態の管理も容易になりました。

## 実施内容

### 1. Headerコンポーネントの実装

#### 機能
- **サービスロゴ**: 「Salmon Run Scenario Hub」のロゴとタイトルを表示
- **メインメニュー**: 
  - 「探す」（ホームページへのリンク）
  - 「解析」（画像解析ページへのリンク）
- **ユーザーメニュー**: 
  - ログイン時: ユーザー情報をドロップダウンメニューで表示（メールアドレス、ログアウト）
  - 未ログイン時: ログインボタンを表示

#### 技術的な実装
- **認証状態の監視**: Supabaseの`onAuthStateChange`を使用して、認証状態の変更をリアルタイムで監視
- **Stickyヘッダー**: `sticky top-0`を使用してスクロール時に上部に固定
- **アクティブページのハイライト**: 現在のページパスに基づいてメニュー項目をハイライト表示
- **モバイル対応**: ハンバーガーメニューを実装（768px以下で表示）

#### デザイン
- **カラーテーマ**: サーモンランの世界観に基づいたダークグレー（`bg-gray-900`）とオレンジ（`text-orange-500`）を使用
- **アクティブ状態**: アクティブなメニュー項目はオレンジ背景で表示
- **ホバーエフェクト**: メニュー項目にホバー時のトランジション効果を適用
- **レスポンシブ**: デスクトップとモバイルで異なるレイアウトを提供

### 2. Footerコンポーネントの実装

#### 機能
- **著作権表示**: 現在の年を動的に表示（`© 2025 Salmon Run Scenario Hub. All rights reserved.`）
- **ナビゲーションリンク**:
  - 利用規約（`/terms`）
  - プライバシーポリシー（`/privacy`）
  - フィードバック（GitHub Issuesへのリンク）

#### デザイン
- **レイアウト**: フレックスレイアウトで、モバイルでは縦並び、デスクトップでは横並びに配置
- **スタイリング**: ダークグレー背景、グレーのボーダー、リンクはホバー時にオレンジ色に変化

### 3. レイアウトへの組み込み

- **`app/layout.tsx`の更新**: 
  - Headerコンポーネントを追加
  - Footerコンポーネントを追加
  - フレックスレイアウト（`flex flex-col min-h-screen`）を使用して、フッターを常にページ下部に配置
  - 背景色をダークグレー（`bg-gray-900`）に統一

### 4. 既存コードの整理

- **`app/page.tsx`の更新**:
  - 既存のヘッダー部分（タイトルと「画像解析」ボタン）を削除
  - 共通Headerコンポーネントに移行
  - 不要な`Link`コンポーネントのインポートを削除

### 5. 依存関係の追加

- **Radix UIコンポーネント**: 
  - `@radix-ui/react-dropdown-menu`: ドロップダウンメニューの実装
- **ユーティリティライブラリ**:
  - `class-variance-authority`: クラス名のバリアント管理
  - `clsx`: 条件付きクラス名の結合
  - `tailwind-merge`: Tailwindクラス名のマージ（競合解決）
- **アイコンライブラリ**:
  - `lucide-react`: アイコンコンポーネント（Menu, X, User, LogOut, LogIn）

### 6. ユーティリティ関数の追加

- **`lib/utils/cn.ts`**: 
  - `clsx`と`tailwind-merge`を使用してクラス名をマージするユーティリティ関数
  - shadcn/uiスタイルのコンポーネントで使用

## 技術的な実装詳細

### 認証状態の監視

```typescript
useEffect(() => {
  const supabase = createClient()

  // 初期ユーザー状態を取得
  supabase.auth.getUser().then(({ data: { user } }) => {
    setUser(user)
    setLoading(false)
  })

  // 認証状態の変更を監視
  const {
    data: { subscription },
  } = supabase.auth.onAuthStateChange((_event, session) => {
    setUser(session?.user ?? null)
  })

  return () => {
    subscription.unsubscribe()
  }
}, [])
```

この実装により、ログイン・ログアウト時にヘッダーの表示が即座に更新されます。

### モバイルメニューの実装

- ハンバーガーアイコンをクリックすると、モバイルメニューが展開/折りたたまれます
- メニュー項目をクリックすると、自動的にメニューが閉じます
- デスクトップでは常に横並びのメニューが表示されます

### アクティブページの判定

```typescript
const pathname = usePathname()
const isActive = (path: string) => pathname === path
```

`usePathname`フックを使用して現在のパスを取得し、メニュー項目のアクティブ状態を判定しています。

## 変更ファイル

### 新規作成
- `app/components/layout/Header.tsx` - ヘッダーコンポーネント
- `app/components/layout/Footer.tsx` - フッターコンポーネント
- `lib/utils/cn.ts` - クラス名マージユーティリティ関数
- `PR_DESCRIPTION_ISSUE10.md` - 本PR説明文

### 更新
- `app/layout.tsx` - HeaderとFooterを組み込み、レイアウト構造を更新
- `app/page.tsx` - 既存のヘッダー部分を削除し、共通コンポーネントに移行
- `package.json` - 必要な依存関係を追加

## UI/UXの改善

- **統一されたナビゲーション**: すべてのページで一貫したナビゲーションを提供
- **ログイン状態の可視化**: ユーザーが現在ログインしているかどうかを一目で確認可能
- **アクセシビリティ**: 適切なARIAラベルとキーボードナビゲーションをサポート
- **レスポンシブデザイン**: モバイル、タブレット、デスクトップのすべての画面サイズに対応
- **視覚的フィードバック**: ホバー、フォーカス、アクティブ状態の視覚的フィードバックを提供

## デザイン仕様

### カラーパレット
- **背景色**: `bg-gray-900`（ダークグレー）
- **テキスト色**: `text-gray-100`（ライトグレー）、`text-gray-300`（ミディアムグレー）
- **アクセント色**: `text-orange-500`（オレンジ）、`bg-orange-500`（オレンジ背景）
- **ボーダー色**: `border-gray-700`（ダークグレーボーダー）

### スペーシング
- **ヘッダーの高さ**: `h-16`（64px）
- **コンテナのパディング**: `px-4`（16px）
- **メニュー項目間のスペース**: `space-x-6`（24px）

### タイポグラフィ
- **ロゴ**: `text-2xl font-bold`（24px、太字）
- **メニュー項目**: `text-sm font-medium`（14px、中太）
- **フッターテキスト**: `text-sm`（14px）

## 期待される動作

- ✅ サーモンランの世界観（ダークグレー・オレンジ）に基づいた統一感のあるデザインが表示されること
- ✅ ログイン状態に応じてヘッダーの表示が即座に切り替わること
- ✅ スクロール時にヘッダーが上部に追従（sticky）すること
- ✅ モバイルデバイスでハンバーガーメニューが正しく動作すること
- ✅ アクティブなページのメニュー項目がハイライト表示されること

## 今後の拡張可能性

- **プロフィールページ**: ユーザーメニューからプロフィールページへのリンクを追加
- **通知機能**: ヘッダーに通知アイコンを追加
- **検索機能**: ヘッダーに検索バーを追加
- **お気に入り**: ヘッダーにお気に入りページへのリンクを追加
- **多言語対応**: 言語切り替え機能の追加

## 関連Issue

Closes #10

## 備考

- ログイン機能は既存のGoogle認証（`lib/auth/google-auth.ts`）を使用
- ログアウト時はホームページにリダイレクトし、ページをリフレッシュ
- モバイルメニューは`md:`ブレークポイント（768px）を境界として表示/非表示が切り替わります
- フッターのリンク（利用規約、プライバシーポリシー）は、将来的に実装されるページへのリンクです

